.nolist
.include "m328Pdef.inc"
.list

INICIO:
	LDI R16, 0b11111111
	OUT DDRB, R16
	LDI R16, 0b00000000
	OUT DDRD, R16
	LDI R16, 0b00000001
	OUT PORTD, R16

	LDI R16, 0
	CALL DECODIFICAR
	OUT PORTB, R0

PRINCIPAL:
	SOLTO:
		SBIC PIND, PD0
		RJMP SOLTO
		RJMP PRESSIONADO

	PRESSIONADO:
		SBIS PIND, PD0
		RJMP PRESSIONADO
		CALL INCREMENTAR
		CALL DECODIFICAR
		OUT PORTB, R0
		RJMP SOLTO
	
INCREMENTAR:
	CPI R16, 9
	BREQ ZERAR
		INC R16
		RET
	ZERAR:
		LDI R16, 0
		RET

DECODIFICAR:
    LDI ZH, HIGH(TABELA << 1)
    LDI ZL, LOW(TABELA << 1)
    ADD ZL, R16
    BRCC LEITURA
    INC ZH
    LEITURA:
        LPM R0, Z
    RET

TABELA:
	.db 0b00111111, 0b00000110, 0b01011011, 0b01001111, 0b01100110, 0b01101101, 0b01111101, 0b00000111, 0b01111111, 0b01101111
