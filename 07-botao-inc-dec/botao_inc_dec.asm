.nolist
.include "m328Pdef.inc"
.list

INICIO:
	LDI R16, 0b11111111
	OUT DDRB, R16
	LDI R16, 0b00000000
	OUT DDRD, R16
	LDI R16, 0b00000011
	OUT PORTD, R16

	LDI R16, 0
	CALL DECODIFICAR
	OUT PORTB, R0

PRINCIPAL:
	INC_SOLTO:
		SBIC PIND, PD0
		RJMP DEC_SOLTO
		RJMP INC_PRESSIONADO
	INC_PRESSIONADO:
		SBIS PIND, PD0
		RJMP INC_PRESSIONADO
		CALL INCREMENTAR
		CALL DECODIFICAR
		OUT PORTB, R0
		RJMP INC_SOLTO

	DEC_SOLTO:
		SBIC PIND, PD1
		RJMP INC_SOLTO
		RJMP DEC_PRESSIONADO
	DEC_PRESSIONADO:
		SBIS PIND, PD1
		RJMP DEC_PRESSIONADO
		CALL DECREMENTAR
		CALL DECODIFICAR
		OUT PORTB, R0
		RJMP DEC_SOLTO

INCREMENTAR:
	CPI R16, 9
	BREQ ZERAR
		INC R16
		RET
	ZERAR:
		LDI R16, 0
		RET

DECREMENTAR:
	CPI R16, 0
	BREQ FILLAR
		DEC R16
		RET
	MAXIMIZAR:
		LDI R16, 9
		RET

DECODIFICAR:
    LDI ZH, HIGH(TABELA << 1)
    LDI ZL, LOW(TABELA << 1)
    ADD ZL, R16
    BRCC LEITURA
    INC ZH
    LEITURA:
        LPM R0, Z
    RET

TABELA:
	.db 0b00111111, 0b00000110, 0b01011011, 0b01001111, 0b01100110, 0b01101101, 0b01111101, 0b00000111, 0b01111111, 0b01101111
